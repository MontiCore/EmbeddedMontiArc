package de.rwth.montisim.agent.network;

component AutopilotCritic<N1 training_vehicles=5> {
    ports
        in Q^{training_vehicles, 26} state,
        in Q^{25} self_state,
        in Q(-1:1)^{3} action,
        out Q(-oo:oo)^{1} qvalues;

    implementation CNN {
        (
            state ->
            FullyConnected(units=300) ->
            Relu() ->
            FullyConnected(units=600)
        |
            action ->
            FullyConnected(units=600)
        )->
        Add() ->
        FullyConnected(units=600) ->
        Relu() ->
        FullyConnected(units=1) ->
        qvalues;
    }

}
