<!DOCTYPE html>
<html>
   <head>
      <script type="text/javascript" src="https://code.jquery.com/jquery-git.js"></script>
      <title>I framed it</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width">
      <script type="text/javascript" src="uploadImageSite.js"></script>
      <link href="uploadImageSite.css" rel="stylesheet" type="text/css" />
      
   </head>
   <body>
      <div id="dragDiv" class="section">
         <div>The div below receives dragged in files</div>
         <div id="dropTarget" class="dropEnabled"></div>
      </div>
      <div id="browseDiv" class="section">
         <input type="file" id="browsedFile">
         <button id="upload">Upload</button>
         <button id="cluster">Cluster</button>
      </div>
      <div id="iframeDiv" class="section">
         <div id="iframeTarget"></div>
      </div>
      <script type="application/javascript">
         
                 
      </script>
      <script>
         $(document).ready(function(){
             main();
             var buttonCluster=document.getElementById('cluster');
             
             buttonCluster.addEventListener("click", function(e){
                Module.init();
                var canvas = document.getElementById('ClusterResult');
                var context=canvas.getContext('2d');

                canvas.width = img.width;
                canvas.height = img.height;            
                context.drawImage(img, 0, 0, 50, 50);
                var pixelData = context.getImageData(0, 0, 50, 50).data;
                var dataForClusterer=new Array(2500);
                var counter=0;
                for(var i=0;i<2500;++i){
                    dataForClusterer[i]=new Array(3);
                    dataForClusterer[i][0]=pixelData[counter];
                    dataForClusterer[i][1]=pixelData[counter+1];
                    dataForClusterer[i][2]=pixelData[counter+2];
                    //dataForClusterer[i][0]=pixelData[i];
                    counter=counter + 4;
                }
                Module.setImgFront(dataForClusterer);
                Module.execute();
                var result = Module.getClusters();
                var newImgData=context.createImageData(100,100);
                counter=0;
                for(var i=0;i<result.data.length;i++){
                    if(result[i][0]==1){
                        newImgData[counter]=0;
                        newImgData[counter+1]=0;
                        newImgData[counter+2]=0;
                        newImgData[counter+3]=255;
                        counter=counter + 4;
                    }else if(result[i][0]==2){
                        newImgData[counter]=255;
                        newImgData[counter+1]=255;
                        newImgData[counter+2]=255;
                        newImgData[counter+3]=255;
                        counter=counter + 4;
                    }else if(result[i][0]==3){
                        newImgData[counter]=136;
                        newImgData[counter+1]=136;
                        newImgData[counter+2]=136;
                        newImgData[counter+3]=255;
                        counter=counter + 4;
                    }else if(result[i][0]==4){
                        newImgData[counter]=77;
                        newImgData[counter+1]=77;
                        newImgData[counter+2]=77;
                        newImgData[counter+3]=255;
                        counter=counter + 4;
                    }
                }
                context.putImageData(newImgData,0,0);
             });
            /*function resizeIFrameToFitContent( iFrame ) {
         
             iFrame.width  = iFrame.contentWindow.document.body.scrollWidth;
             iFrame.height = iFrame.contentWindow.document.body.scrollHeight;
         }
         document.getElementById
         //window.addEventListener('DOMContentLoaded', function(e) {
         
             var iFrame = $("#iframeTarget > iframe")[0];
             resizeIFrameToFitContent( iFrame );
             console.log("updated div");
         //} );*/
         });
         
      </script>
      
    <script type="text/javascript" src="objectDetector1.js"></script>
   </body>
</html>