script:
-
  count=$(find  -type d -name ".git" | wc -l)
  echo $count
  if [ "$count" -gt 0 ]
  then
  echo $count
  find -type d -name ".git" -exec sh -c 'cd $0 && cd .. && git pull' {} \
  else
  curl "https://api.github.com/orgs/EmbeddedMontiArc/repos?per_page=200" |  grep -e 'git_url*' | cut -d \" -f 4 |xargs -L1 git clone
  fi;
language: ruby
after_success:
- mvn deploy --debug --settings "./settings.xml"
- java -jar target/reporting-0.0.3-SNAPSHOT-REWORK-jar-with-dependencies.jar out report -tt true
-
  SOURCE_BRANCH="master"
  TARGET_BRANCH="master"
  REPO=`git config remote.origin.url`
  SSH_REPO=${REPO/https:\/\/github.com\//git@github.com:}
  SHA=`git rev-parse --verify HEAD`
  git config --global user.email "travis@travis-ci.org"
  git config --global user.name "Travis CI"
  ENCRYPTED_KEY_VAR="encrypted_${ENCRYPTION_LABEL}_key"
  ENCRYPTED_IV_VAR="encrypted_${ENCRYPTION_LABEL}_iv"
  ENCRYPTED_KEY=${!ENCRYPTED_KEY_VAR}
  ENCRYPTED_IV=${!ENCRYPTED_IV_VAR}
  openssl aes-256-cbc -K $ENCRYPTED_KEY -iv $ENCRYPTED_IV -in ../deploy_key.enc -out ../deploy_key -d
  chmod 600 ../deploy_key
  eval `ssh-agent -s`
  ssh-add deploy_key;
-
  git add "report/data.json"
  git add "report/dataEWT.json"
  git commit -m "Updating JSONDATA ${SHA}"
  git push $SSH_REPO $TARGET_BRANCH;
env: 
  global:
  - ENCRYPTION_LABEL= 7d5c9954841a
  - COMMIT_AUTHOR_EMAIL= "h.malte.f@googlemail.com"