/**
 * ====
 *     ====
 *         ====
 *             ====
 *                 ====
 *                     ====
 *                         ====
 *                             ====
 *                                 ====
 *                                     ====
 *                                         ====
 *                                             ====
 *                                                 ====
 *                                                     ====
 *                                                         ====
 *                                                             ******************************************************************************
 *                                                              MontiCAR Modeling Family, www.se-rwth.de
 *                                                              Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                                              All rights reserved.
 *
 *                                                              This project is free software; you can redistribute it and/or
 *                                                              modify it under the terms of the GNU Lesser General Public
 *                                                              License as published by the Free Software Foundation; either
 *                                                              version 3.0 of the License, or (at your option) any later version.
 *                                                              This library is distributed in the hope that it will be useful,
 *                                                              but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                                              MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                                              Lesser General Public License for more details.
 *
 *                                                              You should have received a copy of the GNU Lesser General Public
 *                                                              License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                                             *******************************************************************************
 *                                                         ====
 *
 *                                                         ******************************************************************************
 *                                                          MontiCAR Modeling Family, www.se-rwth.de
 *                                                          Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                                          All rights reserved.
 *
 *                                                          This project is free software; you can redistribute it and/or
 *                                                          modify it under the terms of the GNU Lesser General Public
 *                                                          License as published by the Free Software Foundation; either
 *                                                          version 3.0 of the License, or (at your option) any later version.
 *                                                          This library is distributed in the hope that it will be useful,
 *                                                          but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                                          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                                          Lesser General Public License for more details.
 *
 *                                                          You should have received a copy of the GNU Lesser General Public
 *                                                          License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                                         *******************************************************************************
 *                                                     ====
 *
 *                                                     ******************************************************************************
 *                                                      MontiCAR Modeling Family, www.se-rwth.de
 *                                                      Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                                      All rights reserved.
 *
 *                                                      This project is free software; you can redistribute it and/or
 *                                                      modify it under the terms of the GNU Lesser General Public
 *                                                      License as published by the Free Software Foundation; either
 *                                                      version 3.0 of the License, or (at your option) any later version.
 *                                                      This library is distributed in the hope that it will be useful,
 *                                                      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                                      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                                      Lesser General Public License for more details.
 *
 *                                                      You should have received a copy of the GNU Lesser General Public
 *                                                      License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                                     *******************************************************************************
 *                                                 ====
 *
 *                                                 ******************************************************************************
 *                                                  MontiCAR Modeling Family, www.se-rwth.de
 *                                                  Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                                  All rights reserved.
 *
 *                                                  This project is free software; you can redistribute it and/or
 *                                                  modify it under the terms of the GNU Lesser General Public
 *                                                  License as published by the Free Software Foundation; either
 *                                                  version 3.0 of the License, or (at your option) any later version.
 *                                                  This library is distributed in the hope that it will be useful,
 *                                                  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                                  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                                  Lesser General Public License for more details.
 *
 *                                                  You should have received a copy of the GNU Lesser General Public
 *                                                  License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                                 *******************************************************************************
 *                                             ====
 *
 *                                             ******************************************************************************
 *                                              MontiCAR Modeling Family, www.se-rwth.de
 *                                              Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                              All rights reserved.
 *
 *                                              This project is free software; you can redistribute it and/or
 *                                              modify it under the terms of the GNU Lesser General Public
 *                                              License as published by the Free Software Foundation; either
 *                                              version 3.0 of the License, or (at your option) any later version.
 *                                              This library is distributed in the hope that it will be useful,
 *                                              but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                              MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                              Lesser General Public License for more details.
 *
 *                                              You should have received a copy of the GNU Lesser General Public
 *                                              License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                             *******************************************************************************
 *                                         ====
 *
 *                                         ******************************************************************************
 *                                          MontiCAR Modeling Family, www.se-rwth.de
 *                                          Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                          All rights reserved.
 *
 *                                          This project is free software; you can redistribute it and/or
 *                                          modify it under the terms of the GNU Lesser General Public
 *                                          License as published by the Free Software Foundation; either
 *                                          version 3.0 of the License, or (at your option) any later version.
 *                                          This library is distributed in the hope that it will be useful,
 *                                          but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                          Lesser General Public License for more details.
 *
 *                                          You should have received a copy of the GNU Lesser General Public
 *                                          License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                         *******************************************************************************
 *                                     ====
 *
 *                                     ******************************************************************************
 *                                      MontiCAR Modeling Family, www.se-rwth.de
 *                                      Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                      All rights reserved.
 *
 *                                      This project is free software; you can redistribute it and/or
 *                                      modify it under the terms of the GNU Lesser General Public
 *                                      License as published by the Free Software Foundation; either
 *                                      version 3.0 of the License, or (at your option) any later version.
 *                                      This library is distributed in the hope that it will be useful,
 *                                      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                      Lesser General Public License for more details.
 *
 *                                      You should have received a copy of the GNU Lesser General Public
 *                                      License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                     *******************************************************************************
 *                                 ====
 *
 *                                 ******************************************************************************
 *                                  MontiCAR Modeling Family, www.se-rwth.de
 *                                  Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                                  All rights reserved.
 *
 *                                  This project is free software; you can redistribute it and/or
 *                                  modify it under the terms of the GNU Lesser General Public
 *                                  License as published by the Free Software Foundation; either
 *                                  version 3.0 of the License, or (at your option) any later version.
 *                                  This library is distributed in the hope that it will be useful,
 *                                  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                                  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                                  Lesser General Public License for more details.
 *
 *                                  You should have received a copy of the GNU Lesser General Public
 *                                  License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                                 *******************************************************************************
 *                             ====
 *
 *                             ******************************************************************************
 *                              MontiCAR Modeling Family, www.se-rwth.de
 *                              Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                              All rights reserved.
 *
 *                              This project is free software; you can redistribute it and/or
 *                              modify it under the terms of the GNU Lesser General Public
 *                              License as published by the Free Software Foundation; either
 *                              version 3.0 of the License, or (at your option) any later version.
 *                              This library is distributed in the hope that it will be useful,
 *                              but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                              MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                              Lesser General Public License for more details.
 *
 *                              You should have received a copy of the GNU Lesser General Public
 *                              License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                             *******************************************************************************
 *                         ====
 *
 *                         ******************************************************************************
 *                          MontiCAR Modeling Family, www.se-rwth.de
 *                          Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                          All rights reserved.
 *
 *                          This project is free software; you can redistribute it and/or
 *                          modify it under the terms of the GNU Lesser General Public
 *                          License as published by the Free Software Foundation; either
 *                          version 3.0 of the License, or (at your option) any later version.
 *                          This library is distributed in the hope that it will be useful,
 *                          but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                          Lesser General Public License for more details.
 *
 *                          You should have received a copy of the GNU Lesser General Public
 *                          License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                         *******************************************************************************
 *                     ====
 *
 *                     ******************************************************************************
 *                      MontiCAR Modeling Family, www.se-rwth.de
 *                      Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                      All rights reserved.
 *
 *                      This project is free software; you can redistribute it and/or
 *                      modify it under the terms of the GNU Lesser General Public
 *                      License as published by the Free Software Foundation; either
 *                      version 3.0 of the License, or (at your option) any later version.
 *                      This library is distributed in the hope that it will be useful,
 *                      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                      Lesser General Public License for more details.
 *
 *                      You should have received a copy of the GNU Lesser General Public
 *                      License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                     *******************************************************************************
 *                 ====
 *
 *                 ******************************************************************************
 *                  MontiCAR Modeling Family, www.se-rwth.de
 *                  Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *                  All rights reserved.
 *
 *                  This project is free software; you can redistribute it and/or
 *                  modify it under the terms of the GNU Lesser General Public
 *                  License as published by the Free Software Foundation; either
 *                  version 3.0 of the License, or (at your option) any later version.
 *                  This library is distributed in the hope that it will be useful,
 *                  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *                  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *                  Lesser General Public License for more details.
 *
 *                  You should have received a copy of the GNU Lesser General Public
 *                  License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *                 *******************************************************************************
 *             ====
 *
 *             ******************************************************************************
 *              MontiCAR Modeling Family, www.se-rwth.de
 *              Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *              All rights reserved.
 *
 *              This project is free software; you can redistribute it and/or
 *              modify it under the terms of the GNU Lesser General Public
 *              License as published by the Free Software Foundation; either
 *              version 3.0 of the License, or (at your option) any later version.
 *              This library is distributed in the hope that it will be useful,
 *              but WITHOUT ANY WARRANTY; without even the implied warranty of
 *              MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *              Lesser General Public License for more details.
 *
 *              You should have received a copy of the GNU Lesser General Public
 *              License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *             *******************************************************************************
 *         ====
 *
 *         ******************************************************************************
 *          MontiCAR Modeling Family, www.se-rwth.de
 *          Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *          All rights reserved.
 *
 *          This project is free software; you can redistribute it and/or
 *          modify it under the terms of the GNU Lesser General Public
 *          License as published by the Free Software Foundation; either
 *          version 3.0 of the License, or (at your option) any later version.
 *          This library is distributed in the hope that it will be useful,
 *          but WITHOUT ANY WARRANTY; without even the implied warranty of
 *          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *          Lesser General Public License for more details.
 *
 *          You should have received a copy of the GNU Lesser General Public
 *          License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *         *******************************************************************************
 *     ====
 *
 *     ******************************************************************************
 *      MontiCAR Modeling Family, www.se-rwth.de
 *      Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *      All rights reserved.
 *
 *      This project is free software; you can redistribute it and/or
 *      modify it under the terms of the GNU Lesser General Public
 *      License as published by the Free Software Foundation; either
 *      version 3.0 of the License, or (at your option) any later version.
 *      This library is distributed in the hope that it will be useful,
 *      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *      Lesser General Public License for more details.
 *
 *      You should have received a copy of the GNU Lesser General Public
 *      License along with this project. If not, see <http://www.gnu.org/licenses/>.
 *     *******************************************************************************
 * ====
 *
 * ******************************************************************************
 *  MontiCAR Modeling Family, www.se-rwth.de
 *  Copyright (c) 2017, Software Engineering Group at RWTH Aachen,
 *  All rights reserved.
 *
 *  This project is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU Lesser General Public
 *  License as published by the Free Software Foundation; either
 *  version 3.0 of the License, or (at your option) any later version.
 *  This library is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 *  Lesser General Public License for more details.
 *
 *  You should have received a copy of the GNU Lesser General Public
 *  License along with this project. If not, see <http://www.gnu.org/licenses/>.
 * *******************************************************************************
 */
package simulation.util;

import org.apache.commons.math3.geometry.euclidean.threed.Vector3D;
import org.apache.commons.math3.linear.*;
import org.junit.*;

import java.util.AbstractMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

import static org.junit.Assert.*;

/**
 * Class that tests the MathHelper class
 */
public class MathHelperTest {

    @BeforeClass
    public static void setUpClass() {
        Log.setLogEnabled(false);
    }

    @AfterClass
    public static void tearDownClass() {
        Log.setLogEnabled(true);
    }

    @Test
    public void testMatrixEquals() {
        // Test equal case
        RealMatrix matrix1 = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        RealMatrix matrix2 = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        assertTrue(MathHelper.matrixEquals(matrix1, matrix2, 0.0000001));

        // Test almost equal case
        matrix1 = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        matrix2 = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        matrix2 = matrix2.scalarAdd(0.00000002);
        assertTrue(MathHelper.matrixEquals(matrix1, matrix2, 0.0000001));

        // Test not equal case
        matrix1 = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        matrix2 = new BlockRealMatrix(new double[][]{{0.034, 0.3, 0.853}, {0.82356, 0.378, 0.385}, {1.3534, 0.1235, 23.248}});
        assertFalse(MathHelper.matrixEquals(matrix1, matrix2, 0.0000001));
    }

    @Test
    public void testMatrixInvert() {
        // Invert - Invert should be equal
        RealMatrix matrix = new BlockRealMatrix(new double[][]{{23.4, 3.2, 9.3}, {7.5, 9.8, 29.3}, {1.2, 0.8346, 238.3}});
        RealMatrix inverse1 = MathHelper.matrixInvert(matrix);
        RealMatrix inverse2 = MathHelper.matrixInvert(inverse1);
        assertTrue(MathHelper.matrixEquals(matrix, inverse2, 0.0000001));

        // Invert - Invert should be equal
        matrix = new BlockRealMatrix(new double[][]{{0.034, 0.3, 0.853}, {0.82356, 0.378, 0.385}, {1.3534, 0.1235, 23.248}});
        inverse1 = MathHelper.matrixInvert(matrix);
        inverse2 = MathHelper.matrixInvert(inverse1);
        assertTrue(MathHelper.matrixEquals(matrix, inverse2, 0.0000001));
    }

    @Test(expected = IllegalArgumentException.class)
    public void matrixInvertNotSquare() {
        RealMatrix matrix = new BlockRealMatrix(new double[][]{{0.034, 0.3}, {0.82356, 0.378}, {1.3534, 0.1235}});
        MathHelper.matrixInvert(matrix);
    }

    @Test(expected = IllegalArgumentException.class)
    public void matrixInvertSingular() {
        RealMatrix matrix = new BlockRealMatrix(new double[][]{{0.0, 0.0, 0.0}, {0.0, 0.0, 0.0}, {0.0, 0.0, 0.0}});
        MathHelper.matrixInvert(matrix);
    }

    @Test
    public void testVectorEquals() {
        // Test equal case
        RealVector vector1 = new ArrayRealVector(new double[]{23.237, 239.258, 0.2374});
        RealVector vector2 = new ArrayRealVector(new double[]{23.237, 239.258, 0.2374});
        assertTrue(MathHelper.vectorEquals(vector1, vector2, 0.0000001));

        // Test almost equal case
        vector1 = new ArrayRealVector(new double[]{23.237, 239.258, 0.2374});
        vector2 = new ArrayRealVector(new double[]{23.237, 239.258, 0.2374});
        vector2 = vector2.mapAdd(0.00000002);
        assertTrue(MathHelper.vectorEquals(vector1, vector2, 0.0000001));

        // Test not equal case
        vector1 = new ArrayRealVector(new double[]{23.237, 239.258, 0.2374});
        vector2 = new ArrayRealVector(new double[]{0.2537, 87.258, 0.05739});
        assertFalse(MathHelper.vectorEquals(vector1, vector2, 0.0000001));
    }

    @Test
    public void testVectorToCrossProductMatrix() {
        // Compare with default cross product computation
        double[] vectorEntries1 = {23.237, 239.258, 0.2374};
        double[] vectorEntries2 = {0.2537, 87.258, 0.05739};
        RealVector vector1 = new ArrayRealVector(vectorEntries1);
        RealVector vector2 = new ArrayRealVector(vectorEntries2);
        RealMatrix crossProductMatrixVector1 = MathHelper.vectorToCrossProductMatrix(vector1);
        RealVector crossProduct1 = crossProductMatrixVector1.operate(vector2);
        Vector3D vector3 = new Vector3D(vectorEntries1);
        Vector3D vector4 = new Vector3D(vectorEntries2);
        Vector3D crossProduct2tmp = vector3.crossProduct(vector4);
        double[] vectorEntries3 = {crossProduct2tmp.getX(), crossProduct2tmp.getY(), crossProduct2tmp.getZ()};
        RealVector crossProduct2 = new ArrayRealVector(vectorEntries3);
        assertTrue(MathHelper.vectorEquals(crossProduct1, crossProduct2, 0.00000001));

        // Non 3D vector throws exception
        boolean exceptionCaught5 = false;
        double[] vectorEntries5 = {0.2537, 87.258, 0.05739, 23.5295};
        RealVector vector5 = new ArrayRealVector(vectorEntries5);

        try {
            MathHelper.vectorToCrossProductMatrix(vector5);
        }
        catch (Exception e) {
            exceptionCaught5 = true;
        }

        assertTrue(exceptionCaught5);
    }

    @Test
    public void testVectorCrossProduct() throws Exception {
        // Compare with default cross product computation
        double[] vectorEntries1 = {23.237, 239.258, 0.2374};
        double[] vectorEntries2 = {0.2537, 87.258, 0.05739};
        RealVector vector1 = new ArrayRealVector(vectorEntries1);
        RealVector vector2 = new ArrayRealVector(vectorEntries2);
        RealVector crossProduct1 = MathHelper.crossProduct(vector1, vector2);
        Vector3D vector3 = new Vector3D(vectorEntries1);
        Vector3D vector4 = new Vector3D(vectorEntries2);
        Vector3D crossProduct2tmp = vector3.crossProduct(vector4);
        double[] vectorEntries3 = {crossProduct2tmp.getX(), crossProduct2tmp.getY(), crossProduct2tmp.getZ()};
        RealVector crossProduct2 = new ArrayRealVector(vectorEntries3);
        assertTrue(MathHelper.vectorEquals(crossProduct1, crossProduct2, 0.00000001));

        // Non 3D vector throws exception
        boolean exceptionCaught5 = false;
        double[] vectorEntries5 = {0.2537, 87.258};
        double[] vectorEntries6 = {23.2537, 0.34258};
        RealVector vector5 = new ArrayRealVector(vectorEntries5);
        RealVector vector6 = new ArrayRealVector(vectorEntries6);

        try {
            MathHelper.crossProduct(vector5, vector6);
        }
        catch (Exception e) {
            exceptionCaught5 = true;
        }

        assertTrue(exceptionCaught5);
    }

    @Test
    public void testCheckIntersection2D() {
        List<Map.Entry<RealVector, RealVector>> list1 = new LinkedList<>();
        Map.Entry<RealVector, RealVector> e1 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{0.0, 0.0, 0.0}), new ArrayRealVector(new double[]{4.0, 0.0, 0.0}));
        Map.Entry<RealVector, RealVector> e2 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{4.0, 0.0, 0.0}), new ArrayRealVector(new double[]{4.0, 4.0, 0.0}));
        Map.Entry<RealVector, RealVector> e3 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{4.0, 4.0, 0.0}), new ArrayRealVector(new double[]{0.0, 4.0, 0.0}));
        Map.Entry<RealVector, RealVector> e4 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{0.0, 4.0, 0.0}), new ArrayRealVector(new double[]{0.0, 0.0, 0.0}));
        list1.add(e1); list1.add(e2); list1.add(e3); list1.add(e4);

        List<Map.Entry<RealVector, RealVector>> list2 = new LinkedList<>();
        assertFalse(MathHelper.checkIntersection2D(list1, list2));

        Map.Entry<RealVector, RealVector> e5 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{0.0, 10.0, 0.0}), new ArrayRealVector(new double[]{4.0, 10.0, 0.0}));
        Map.Entry<RealVector, RealVector> e6 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{4.0, 10.0, 0.0}), new ArrayRealVector(new double[]{4.0, 14.0, 0.0}));
        Map.Entry<RealVector, RealVector> e7 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{4.0, 14.0, 0.0}), new ArrayRealVector(new double[]{0.0, 14.0, 0.0}));
        Map.Entry<RealVector, RealVector> e8 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{0.0, 14.0, 0.0}), new ArrayRealVector(new double[]{0.0, 10.0, 0.0}));
        list2.add(e5); list2.add(e6); list2.add(e7); list2.add(e8);
        assertFalse(MathHelper.checkIntersection2D(list1, list2));

        List<Map.Entry<RealVector, RealVector>> list3 = new LinkedList<>();
        Map.Entry<RealVector, RealVector> e9 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{2.0, 12.0, 0.0}), new ArrayRealVector(new double[]{-3.0, 7.0, 0.0}));
        Map.Entry<RealVector, RealVector> e10 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{-3.0, 7.0, 0.0}), new ArrayRealVector(new double[]{2.0, 2.0, 0.0}));
        Map.Entry<RealVector, RealVector> e11 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{2.0, 2.0, 0.0}), new ArrayRealVector(new double[]{7.0, 7.0, 0.0}));
        Map.Entry<RealVector, RealVector> e12 = new AbstractMap.SimpleEntry<RealVector, RealVector>(new ArrayRealVector(new double[]{7.0, 7.0, 0.0}), new ArrayRealVector(new double[]{2.0, 12.0, 0.0}));
        list3.add(e9); list3.add(e10); list3.add(e11); list3.add(e12);
        assertTrue(MathHelper.checkIntersection2D(list1, list3));
        assertTrue(MathHelper.checkIntersection2D(list2, list3));
    }

    @Test
    public void testRandomLong() {
        assertTrue(MathHelper.randomLong(0L, 0L) == 0L);
        assertTrue(MathHelper.randomLong(-1L, -1L) == -1L);
        assertTrue(MathHelper.randomLong(Long.MIN_VALUE, Long.MIN_VALUE) == Long.MIN_VALUE);
        assertTrue(MathHelper.randomLong(Long.MAX_VALUE, Long.MAX_VALUE) == Long.MAX_VALUE);
        assertTrue(MathHelper.randomLong(20L, 20L) == 20L);

        long result1 = MathHelper.randomLong(-10L, 10L);
        assertTrue(result1 >= -10L && result1 <= 10L);

        long result2 = MathHelper.randomLong(Long.MIN_VALUE / 2L, Long.MAX_VALUE / 2L);
        assertTrue(result2 >= Long.MIN_VALUE / 2L && result2 <= Long.MAX_VALUE / 2L);
    }

    @Test
    public void testRandomInt() {
        assertTrue(MathHelper.randomInt(0, 0) == 0);
        assertTrue(MathHelper.randomInt(-1, -1) == -1);
        assertTrue(MathHelper.randomInt(Integer.MIN_VALUE, Integer.MIN_VALUE) == Integer.MIN_VALUE);
        assertTrue(MathHelper.randomInt(Integer.MAX_VALUE, Integer.MAX_VALUE) == Integer.MAX_VALUE);
        assertTrue(MathHelper.randomInt(20, 20) == 20);

        long result1 = MathHelper.randomInt(-10, 10);
        assertTrue(result1 >= -10 && result1 <= 10);

        long result2 = MathHelper.randomInt(Integer.MIN_VALUE / 2, Integer.MAX_VALUE / 2);
        assertTrue(result2 >= Integer.MIN_VALUE / 2 && result2 <= Integer.MAX_VALUE / 2);
    }
}