stages:
- linux

TestBuild:
  stage: linux
  image: registry.git.rwth-aachen.de/monticore/embeddedmontiarc/applications/reinforcement_learning/cartpole/rl-fix-new2:latest
  before_script:
    - apt-get update
    - apt-get install -y maven 
  script:
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}@git.rwth-aachen.de/monticore/EmbeddedMontiArc/generators/EMAM2Middleware.git
    - cd EMAM2Middleware
    - mvn clean install -s settings.xml
    - cd target
    - xargs -n 1 cp -v *-jar-with-dependencies.jar<<<"../../Autopilot1/bin/ ../../Autopilot1_random/bin/ ../../Autopilot2/bin/ ../../Autopilot2_random/bin/ ../../Autopilot3/bin/" 
    - cd ../../
    - cd Autopilot1
    - ./install.sh
    - cd ..
    - cd Autopilot1_random
    - ./install.sh
    - cd ..
    - cd Autopilot2
    - ./install.sh
    - cd ..
    - cd Autopilot2_random
    - ./install.sh
    - cd ..
    - cd Autopilot3
    - ./install.sh
    - cd ..