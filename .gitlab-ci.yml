# (c) https://github.com/MontiCore/monticore
stages:
  - linux
  - page
  - trigger_apps

BranchJobLinux:
  stage: linux
  image: registry.git.rwth-aachen.de/monticore/embeddedmontiarc/applications/carlacomponents/ros-maven
  script:
    - mvn -B  clean install -s settings.xml
  except:
    - master

MasterDeployJobLinux:
  stage: linux
  image: maven:3-jdk-8
  #image: registry.git.rwth-aachen.de/monticore/embeddedmontiarc/applications/carlacomponents/ros-maven
  script:
    - mvn -s settings.xml -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn -B clean deploy 
  only:
    - master
  except:
    changes:
      - .gitlab-ci.yml
      - .gitignore
      - README.md

trigger-mnistcalc:
  stage: trigger_apps
  allow_failure: true
  trigger:
    project: monticore/EmbeddedMontiArc/applications/MNISTCalculator
    branch: master
  only:
    - master


pages:
  stage: page
  image: registry.git.rwth-aachen.de/monticore/embeddedmontiarc/applications/carlacomponents/ros-maven
  script:
    - mvn clean site -s settings.xml
    - mv target/site/ public/
  artifacts:
    paths:
      - public
  only:
    - master
  except:
    changes:
      - .gitignore
      - README.md


