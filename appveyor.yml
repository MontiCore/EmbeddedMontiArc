version: '{build}'
skip_tags: true
clone_folder: C:\EMAStudioBuilder
clone_depth: 10
platform:
  - x64
install:
  - ps: |
      if(![System.IO.File]::Exists('C:\dependencies')){
        New-Item -ItemType directory -Path C:\dependencies
        Set-Location -Path C:\dependencies 
        foreach($line in Get-Content C:\EMAStudioBuilder\dependencies.txt) {
          $line
          if($line -match '^\*\*.+'){
            $line.Remove(0,3)
            $line
            $line -match '^.*\/\[^\/]+$'
            $filename = matches[1]
            $filename
            appveyor DownloadFile $line -FileName $filename
            [System.IO.Compression.ZipFile]::ExtractToDirectory($filename, 'C:\EMAStudioBuilder\EMAStudio')
          }
        }
      }
      
  - ps: tree /F
cache:
  - C:\dependencies -> dependencies.txt
